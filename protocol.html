<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูพุฑูุชฺฉู ูุงฺฉูุด ุณุฑุน ุณุฎูฺฏู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals & Slate -->
    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            scroll-behavior: smooth;
        }
        .vazir-font {
            font-family: 'Vazirmatn', sans-serif;
        }
        .tab-active {
            border-color: #4f46e5;
            background-color: #eef2ff;
            color: #4f46e5;
            font-weight: 700;
        }
        .crisis-card-active {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            border-color: #4f46e5;
        }
        .backdrop-blur-sm {
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="bg-stone-50 text-slate-800 vazir-font">

    <div id="app" class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">ูพุฑูุชฺฉู ูุงฺฉูุด ุณุฑุน ุณุฎูฺฏู</h1>
            <p class="mt-2 text-lg text-slate-600">ุฑุงูููุง ุนููุงุช ูุฏุฑุช ุงุฑุชุจุงุทุงุช ุฏุฑ ุจุญุฑุงู</p>
            <button id="showPrinciplesBtn" class="mt-4 inline-flex items-center px-4 py-2 bg-white border border-slate-300 rounded-lg shadow-sm text-slate-700 hover:bg-slate-50 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="ml-2 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                ูุดุงูุฏู ุงุตูู ฺฉูุฏ ูุฑุงุฑุณุงููโุง
            </button>
        </header>

        <section id="crisis-selection">
            <h2 class="text-xl md:text-2xl font-bold text-center mb-6">ฑ. ููุน ุจุญุฑุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</h2>
            <div id="crisis-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
            </div>
        </section>

        <main id="protocol-display" class="mt-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <h2 id="crisis-title" class="text-2xl font-bold mb-2 text-indigo-700"></h2>
            <p id="crisis-description" class="text-slate-600 mb-6"></p>

            <div id="timeline" class="w-full mb-8">
                <div class="flex justify-between items-center">
                    <div class="timeline-step flex-1 text-center" data-phase="1">
                        <div class="text-sm font-bold">ูุงุฒ ฑ</div>
                        <div class="text-xs text-slate-500">ฐ-ฑ ุณุงุนุช</div>
                    </div>
                    <div class="flex-1 border-t-2 border-slate-200"></div>
                    <div class="timeline-step flex-1 text-center" data-phase="2">
                        <div class="text-sm font-bold">ูุงุฒ ฒ</div>
                        <div class="text-xs text-slate-500">ฒ-ถ ุณุงุนุช</div>
                    </div>
                    <div class="flex-1 border-t-2 border-slate-200"></div>
                    <div class="timeline-step flex-1 text-center" data-phase="3">
                        <div class="text-sm font-bold">ูุงุฒ ณ</div>
                        <div class="text-xs text-slate-500">ฑฒ-ดธ ุณุงุนุช</div>
                    </div>
                </div>
                 <div class="relative h-1 bg-slate-200 rounded-full mt-1">
                    <div id="timeline-progress" class="absolute top-0 right-0 h-1 bg-indigo-600 rounded-full transition-all duration-500" style="width: 16.6%;"></div>
                </div>
            </div>

            <nav id="phase-tabs" class="flex border-b border-slate-200 mb-6">
            </nav>
            <div id="phase-content">
            </div>
            
            <!-- Gemini API Integration: Quick Draft Critique Tool -->
            <div id="drafting-tool" class="mt-8 pt-6 border-t border-slate-200">
                <h3 class="text-xl font-bold mb-4 text-slate-800 flex items-center">
                    ุงุจุฒุงุฑ ูพุดโููุณ ุณุฑุน ู ููุฏ ูุญู โจ
                </h3>
                <p class="text-sm text-slate-600 mb-4">ูพุดโููุณ ุจุงูู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ ุชุง ููุด ูุตููุน ุขู ุฑุง ุจุฑ ุงุณุงุณ ุงุตูู ูุงฺฉูุด ุณุฑุน ุณุฎูฺฏู ููุฏ ู ุฎูุงุตูโุณุงุฒ ฺฉูุฏ.</p>
                
                <textarea id="draftInput" rows="6" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 vazir-font text-base" placeholder="ูุชู ูพุดโููุณ ุฎูุฏ ุฑุง ุงูุฌุง ุจููุณุฏ..."></textarea>
                <div id="draftMessage" class="mt-2 text-sm text-red-600 hidden"></div>
                
                <button id="critiqueDraftBtn" class="mt-3 w-full md:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-colors flex items-center justify-center disabled:opacity-50">
                    <svg id="critiqueIcon" xmlns="http://www.w3.org/2000/svg" class="ml-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 01-2 0V3a1 1 0 011-1zm0 16a1 1 0 01-1-1v-1a1 1 0 112 0v1a1 1 0 01-1 1zM4.343 5.757a1 1 0 011.414 0l.707.707a1 1 0 01-1.414 1.414l-.707-.707a1 1 0 010-1.414zm11.314 7.072a1 1 0 010 1.414l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 0zM14.343 5.757a1 1 0 010 1.414l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 0zM5.757 14.343a1 1 0 01-1.414 0l-.707-.707a1 1 0 011.414-1.414l.707.707a1 1 0 010 1.414zM16 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM4 10a1 1 0 01-1 1H2a1 1 0 110-2h1a1 1 0 011 1z" clip-rule="evenodd" /></svg>
                    <svg id="loadingSpinner" class="animate-spin ml-2 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    ููุฏ ู ุชุญูู ูพุดโููุณ
                </button>
                
                <div id="critiqueOutput" class="mt-6 p-4 md:p-6 bg-slate-100 rounded-lg border-t-4 border-indigo-500 hidden">
                    <h4 class="font-bold text-lg mb-3 text-slate-800">ูุชุฌู ุชุญูู ููุด ูุตููุน:</h4>
                    <div id="critiqueContent" class="space-y-4 text-slate-700"></div>
                </div>
            </div>

        </main>

    </div>

    <div id="principlesModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm hidden">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6 md:p-8" dir="rtl">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 class="text-xl font-bold text-slate-900">ุงุตูู ฺฉูุฏ ู ูุฑุงุฑุณุงููโุง</h3>
                <button id="closePrinciplesBtn" class="text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div class="prose max-w-none text-slate-700">
                <p>ุฏุฑ ูุฏุฑุช ุจุญุฑุงูโูุง ูุฏุฑูุ ุงูุฏุงูุงุช ุฑุณุงููโุง ุณุฎูฺฏูุงู ูููู ุฏููุชโูุง ุจุฑ ุงู ุงุตูู ุงุณุชูุงุฑ ุงุณุช ฺฉู ุจุงุฏ ุฏุฑ ุชูุงู ธ ุฏุณุชู ุจุญุฑุงู ุฑุนุงุช ุดูุฏ:</p>
                <div class="overflow-x-auto mt-4">
                    <table class="w-full text-sm border">
                        <thead class="bg-slate-100">
                            <tr>
                                <th class="p-3 border text-right font-bold">ุงุตู ฺฉูุฏ</th>
                                <th class="p-3 border text-right font-bold">ูุญูู ุงุฌุฑุง ุฑุณุงููโุง</th>
                                <th class="p-3 border text-right font-bold">ูุฏู</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-t">
                                <td class="p-3 border font-semibold">ฑ. Speed to Narrative (ุณุฑุนุช ุฑูุงุช)</td>
                                <td class="p-3 border">ุฏุฑ ูุงุฒ ุงูู (ฐ ุชุง ฑ ุณุงุนุช)ุ ุญุช ุงฺฏุฑ ุงุทูุงุนุงุช ูุงูุต ุจุงุดุฏุ ุณุฎูฺฏู ุจุงุฏ ุณุฑุนุงู ุจุงูู ุจุฏูุฏ. **ูุจุงุฏ** ุจฺฏุฐุงุฑุฏ ุฑุณุงููโูุง ุบุฑุฑุณูุ ุฑูุงุช ุจุญุฑุงู ุฑุง ุจุณุงุฒูุฏ. ูุญุชูุง ุงููู: ุชุฃุฏุ ููุฏูุ ฺฉูุชุฑู.</td>
                                <td class="p-3 border">ฺฏุฑูุชู ุงูุญุตุงุฑ ุฑูุงุช ู ุฌููฺฏุฑ ุงุฒ ุดุงุนู.</td>
                            </tr>
                            <tr class="border-t bg-stone-50">
                                <td class="p-3 border font-semibold">ฒ. One Voice Policy (ุชฺฉ ุตุฏุง)</td>
                                <td class="p-3 border">ุฏุฑ ูุงุฒ ุฏูู (ฒ ุชุง ถ ุณุงุนุช)ุ ุชููุง ุณุฎูฺฏูุ ุง ูุฒุฑ ฺฉู ุชูุณุท ุงู ุชุนู ุดุฏูุ ุญู ุงุธูุงุฑูุธุฑ ุฏุงุฑุฏ. ุชูุงู ุฑุณุงููโูุง ุฑุณู ููุธู ุจู ุงุฑุฌุงุน ุจู ุงู ูุฑุฌุน ูุณุชูุฏ. **ูุจุงุฏ** ุงุฌุงุฒู ุฏุงุฏ ููุงูุงุช ูุงู ุง ุญุงุดูโุง ุงุธูุงุฑูุธุฑ ฺฉููุฏ.</td>
                                <td class="p-3 border">ุฌููฺฏุฑ ุงุฒ ุชูุงูุถ ู ุณุฑุฏุฑฺฏู ุนููู.</td>
                            </tr>
                            <tr class="border-t">
                                <td class="p-3 border font-semibold">ณ. Accountability over Excuse (ูุณุฆููุชโูพุฐุฑ ุจุฑ ุชูุฌู)</td>
                                <td class="p-3 border">ุฏุฑ ูุฑ ุจุญุฑุงู (ุจุฎุตูุต ุฒุฑุณุงุฎุชุ ุงูุชุตุงุฏ ู ุญฺฉูุฑุงู)ุ ุฏุฑ ูุงุฒ ุฏูู ุง ุณููุ ุฏููุช ุจุงุฏ ุจุฎุด ุงุฒ ูุณุฆููุช ุฑุง ุจูพุฐุฑุฏ. ูุญู ุจุงุฏ ุญูู **"ุขูฺู ูุง ุงูุฌุงู ุฎูุงูู ุฏุงุฏ"** ุจุงุดุฏุ ูู **"ฺุฑุง ุงู ุงุชูุงู ุงูุชุงุฏ"** (ุชูุฌู).</td>
                                <td class="p-3 border">ุชุฑูู ุงุนุชูุงุฏ ุนููู ู ููุงุด ุตุฏุงูุช.</td>
                            </tr>
                            <tr class="border-t bg-stone-50">
                                <td class="p-3 border font-semibold">ด. Show, Don't Just Tell (ููุงุด ุนูู)</td>
                                <td class="p-3 border">ุจูโุฌุง ุจุงููโูุง ุตุฑูุ ุชุตุงูุฑ ู ูุฏุฆููุง ุนููุงุช ุงุฒ ุญุถูุฑ ุฏุฑ ุตุญููุ ุชูุงุด ุชูโูุง ุงูุฏุงุฏุ ุง ุฌูุณุงุช ููุฑ ุฏููุช ููุชุดุฑ ุดูุฏ. ูุฑุฏู ุจุงุฏ **ุงูุฏุงู ุนูู** ุฑุง ุจุจููุฏ.</td>
                                <td class="p-3 border">ููุงุด ฺฉุงุฑุขูุฏ ู ฺฉูุชุฑู ุงูุถุงุน.</td>
                            </tr>
                            <tr class="border-t">
                                <td class="p-3 border font-semibold">ต. Humanize the Response (ุงูุณุงูโุณุงุฒ)</td>
                                <td class="p-3 border">ุฏุฑ ฺฉูุงุฑ ุขูุงุฑุ ุณุฎูฺฏู ุจุงุฏ ุฑู ุจูุนุฏ ุงูุณุงู ุชูุฑฺฉุฒ ฺฉูุฏุ ุงุฏุง ุงุญุชุฑุงู ุจู ูุฑุจุงูุงูุ ุงุจุฑุงุฒ ููุฏู ุจุง ุฎุงููุงุฏูโูุง ู ูุฏุฑุฏุงู ุงุฒ ุชูุงุดฺฏุฑุงู. ุงู ุงูุฑ ุจู ุฎุตูุต ุฏุฑ ุจูุงุง ุทุจุน ุญุงุช ุงุณุช.</td>
                                <td class="p-3 border">ุงุฌุงุฏ ุญุณ ูุฒุฏฺฉ ู ฺฉุงูุด ูุงุตูู ุฏููุช-ููุช.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const crisisData = {
        'national-security': {
            title: 'ุจุญุฑุงู ุงููุช ููุ ุชุฑูุฑุณู ู ุชุฌุงูุฒ ุฎุงุฑุฌ',
            description: 'ุดุงูู ุญููุงุช ุชุฑูุฑุณุชุ ุนููุงุชโูุง ุฎุฑุงุจฺฉุงุฑุงูู ุง ุชูุดโูุง ูุธุงู ูุณุชูู ฺฉู ฺฉุงู ฺฉุดูุฑ ุฑุง ูุฏู ูุฑุงุฑ ูโุฏููุฏ.',
            icon: '๐ก๏ธ',
            phases: [
                {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุชุฃุฏ ุณุฑุน:** ุชุฃุฏ ุงุตู ูููุน ุญุงุฏุซู ุชูุณุท ุณุฎูฺฏู (ุง ููุงุฏ ุงููุช ุฐโุตูุงุญ) ุจุง ฺฉูุชุฑู ุฌุฒุฆุงุช.",
                        "**ุงูุญุตุงุฑ ุฑูุงุช:** ุตุฑุญุงู ุงุนูุงู ุดูุฏ ฺฉู ุชููุง ููุจุน ุฑุณู ุงุทูุงุนุงุชุ ููุงุฏ ุณุฎูฺฏู ู ุดูุฑุง ุนุงู ุงููุช ูู ุงุณุช.",
                        "**ุตุฏูุฑ ูพุงู ุชุณูุช ู ูุญฺฉููุช ููุฑ.**"
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูุงุทุนุ ููุชุฏุฑุ ููุฏู ุจุง ูุฑุจุงูุงูุ ู ูู.<br>**ูพุงู ุงุตู:** "ุฏุดูู ุฏุฑ ูพ ุชุถุนู ุงููุช ูู ุงุณุชุ ุงุฑุงุฏู ุฏููุช ุจุฑุง ุญูุธ ุงููุชุ ุขููู ุงุณุช." "ุจุฑุฎูุฑุฏ ูุงุทุน ุจุง ูุณุจุจุงู."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชูุฆุชุฑ/X (ุณุฎูฺฏู):** ุจุฑุง ุณุฑุนุช ู ุชุณุฎุฑ ุฑูุงุช ุงููู.<br>**ุฎุจุฑฺฏุฒุงุฑ ุฑุณู (IRNA/ูู):** ุงูุชุดุงุฑ ุจุงูู ฺฉูุชุงู.'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ููุงููฺฏ ุงุทูุงุนุงุช:** ุจุฑฺฏุฒุงุฑ ููุฑ ุฌูุณู ููุงููฺฏ ุจุง ููุงุฏูุง ุงููุช (ูุฒุงุฑุช ุงุทูุงุนุงุชุ ุณูพุงูุ ุงุฑุชุด) ุจุฑุง ฺฉูพุงุฑฺูโุณุงุฒ ุขูุงุฑ ู ุฌุฒุฆุงุช ุนููุงุช.",
                        "**ฺฉููุฑุงูุณ ุฎุจุฑ ฺฉูุชุฑูโุดุฏู:** ุงุนูุงู ุขูุงุฑ ุฏูู (ุชููุงุชุ ุงุจุนุงุฏ) ู ุชุดุฑุญ ูุฎุชุตุฑ ุงูุฏุงู ูุชูุงุจู (ุฏุฑ ุตูุฑุช ูุฌูุฏ).",
                        "**ููุงุด ุงูุฏุงู ุนูู:** ุงูุชุดุงุฑ ุชุตุงูุฑ/ูููโูุง ุงุฒ ุญุถูุฑ ููุงูุงุช ุงุฑุดุฏ ุฏุฑ ูุญู ุญุงุฏุซู ุง ุงุชุงู ุนููุงุช."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูุชุนูุฏุ ุฏููุ ููุงุด ุงูุชุฏุงุฑ ู ฺฉูุชุฑู.<br>**ูฺฉุชู ฺฉูุฏ:** ุงุฒ ูุฌุงูโุฒุฏฺฏ ู ูุนุฏูโูุง ูุจูู ูพุฑูุฒ ุดูุฏ. ุจุฑ ููุด ููุงุฏูุง ุงููุช ุชุฃฺฉุฏ ุดูุฏ. ุงุฒ ุฏุงูู ุฒุฏู ุจู ุดุงุนุงุช ุฎูุฏุฏุงุฑ ุดูุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ุงุฎุจุงุฑ ุฑุณู):** ูพูุดุด ุฒูุฏู ฺฉููุฑุงูุณ ุฎุจุฑ.<br>**ุฑุณุงููโูุง ุงุฌุชูุงุน (ุฑุณู):** ุงูููฺฏุฑุงูฺฉโูุง ุชุฃุฏ ุดุฏู (Confirmed Facts).'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ุงุนูุงู ูุชุงุฌ ุงููู ุชุญููุงุช:** ุญุช ุงฺฏุฑ ูุงูุต ุจุงุดุฏุ ฺฉ ุจุงูู ุฏุฑุจุงุฑูโ ุฑููุฏ ุฏุณุชฺฏุฑ/ุชุญููุงุช ููุชุดุฑ ุดูุฏ.",
                        "**ูพุงู ุฌูุน:** ุงูุชุดุงุฑ ุจุงูู ุฑุณู ุจุง ุงูุถุง ุณุฑุงู ุณู ููู ุง ููุงุฏูุง ุนุงู.",
                        "**ุจุฑูุงููโุฑุฒ ุจุฑุง ููุงุจูู ุฏุฑุงุฒูุฏุช:** ุชูุฑฺฉุฒ ุจุฑ ุจุฑูุงููโูุง ุขุช ุจุฑุง ุชููุช ุงููุช ู ููุงุจูู ุจุง ุชูุฏุฏุงุช ูุดุงุจู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุขูุฏูโูฺฏุฑุ ูุณุฆููุชโูพุฐุฑ ู ูุชุญุฏ.<br>**ูฺฉุชู ฺฉูุฏ:** ุงูุชูุงู ูพุงู "ูุถุนุช ุชุญุช ฺฉูุชุฑู ุงุณุช" ู ุจุงุฒฺฏุฑุฏุงูุฏู ุฌุงูุนู ุจู ุญุงูุช ุนุงุฏ. ุจุฑุฌุณุชู ฺฉุฑุฏู ููุจุณุชฺฏ ูู.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุดุฑุงุช ูพุฑุชุฑุงฺ (ููุงูู ุณุฎูฺฏู):** ุจุฑุง ุชุจู ุงุจุนุงุฏ ุงุณุชุฑุงุชฺฺฉ.<br>**ูพุฎุด ูุตุงุญุจู ุชููุฒูู (ุณุฎูฺฏู ุง ูุฒุฑ ุฐโุฑุจุท):** ุจุง ูุฏู ุงุทููุงูโุจุฎุด ู ูพุงุณุฎ ุจู ุงุจูุงูุงุช.'
                    }
                }
            ]
        },
        'natural-disaster': {
            title: 'ุจุญุฑุงู ุจูุงุง ุทุจุน',
            description: 'ูุงููุฏ ุฒูุฒููุ ุณูุ ุขุชุดโุณูุฒโูุง ุจุฒุฑฺฏ ู ุญูุงุฏุซ ูุดุงุจู ฺฉู ูุงุฒููุฏ ูุงฺฉูุด ุณุฑุน ุงูุฏุงุฏ ูุณุชูุฏ.',
            icon: '๐',
            phases: [
                {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุงุจุฑุงุฒ ุชุฃุณู ู ููุฏู ุดุฏุฏ:** ุงููู ูพุงู ุจุงุฏ ุนุงุทู ู ูุชูุฑฺฉุฒ ุจุฑ ูุฑุฏู ุจุงุดุฏ.",
                        "**ุงุนูุงู ุจุณุฌ ุนููู:** ุงุนูุงู ุจุณุฌ ุดุฏู ููุฑ ุชูุงู ุฏุณุชฺฏุงูโูุง ุงุฌุฑุงุ ุงูุฏุงุฏ ู ูุธุงู.",
                        "**ฺฉุงูุงู ุงูุฏุงุฏ:** ุงุนูุงู ฺฉ ฺฉุงูุงู ูุดุฎุต ุจุฑุง ุฏุฑุงูุช ุงุฎุจุงุฑ ุงูุฏุงุฏ ู ูุฌุงุช (ูุซูุงู ููุงู ุงุญูุฑ)."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ููุฏูุงููุ ูุชูุงุถุนุ ู ูุชูุฑฺฉุฒ ุจุฑ ูุฌุงุช ุฌุงู ุงูุณุงูโูุง.<br>**ูพุงู ุงุตู:** "ุชูุงู ุชูุงู ุฏููุช ุฏุฑ ุฎุฏูุช ุขุณุจโุฏุฏฺฏุงู ุงุณุช." "ููฺฉุงุฑ ู ุขุฑุงูุด ูุฑุฏูุ ุงูููุช ุงุณุช."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชูุฆุชุฑ/X ู ุงูุณุชุงฺฏุฑุงู (ุณุฎูฺฏู):** ุงุฑุณุงู ูพุงู ุนุงุทู ู ุงูุณุงู.<br>**ุฑุงุฏู ู ุชููุฒูู:** ูุทุน ุจุฑูุงููโูุง ู ุงุฑุงุฆู ุจููุชูโูุง ุฎุจุฑ ููุฑ.'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ูุฑฺฉุฒุช ุขูุงุฑ:** ููุงููฺฏ ุจุง ุงูุฑฺุงูุณ ู ููุงู ุงุญูุฑ ุจุฑุง ุงูุชุดุงุฑ ุขูุงุฑ ูุชูุฑฺฉุฒ.",
                        "**ููุงุด ุญุถูุฑ:** ุงูุชุดุงุฑ ุนฺฉุณ ู ููู ุงุฒ ุญุถูุฑ ูุฏุงู ุฑุฆุณโุฌูููุฑ ุง ูุฒุฑุง.",
                        "**ุฏุณุชูุฑุงูุนููโูุง ุงูู:** ุงูุชุดุงุฑ ุฏุณุชูุฑุงูุนููโูุง ุญุงุช ุจุฑุง ููุงุทู ุฏุฑฺฏุฑ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุนููุงุชุ ุดูุงู ู ุฏูู. ููุงุด ฺฉุงุฑุขูุฏ ุฏุณุชฺฏุงูโูุง.<br>**ูฺฉุชู ฺฉูุฏ:** ูพุฑูุฒ ุงุฒ ูุนุฏูโูุง ุฒูุฏููฺฏุงู ุฏุฑุจุงุฑู ุจุงุฒุณุงุฒ. ุชูุฑฺฉุฒ ุจุฑ ูุงุฒ ุงูุฏุงุฏ ู ูุฌุงุช.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุฎุจุฑฺฏุฒุงุฑโูุง ู ุฑุณุงูู ูู:** ฺฏุฒุงุฑุดโูุง ูุฏุงู ุฒูุฏู.<br>**ฺฉุงูุงูโูุง ูพุงูโุฑุณุงู ุฑุณู:** ุงูุชุดุงุฑ ุฏุณุชูุฑุงูุนููโูุง ฺฉูุชุงู.'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ูุงุฒ ุจุนุฏ:** ุงุนูุงู ุฑุณู ูพุงุงู ูุงุฒ ูุฌุงุช ู ุขุบุงุฒ ูุงุฒ ุงุณฺฉุงู ูููุช ู ุจุงุฒุณุงุฒ.",
                        "**ุดูุงูุช ฺฉูฺฉโูุง:** ุงุฑุงุฆู ฺฏุฒุงุฑุด ุงุฒ ฺฉูฺฉโูุง ูุฑุฏู ู ุฏููุช ุจุง ุชุนูุฏ ุจู ุงูุชุดุงุฑ ฺฏุฒุงุฑุดโูุง ุฏูุฑูโุง.",
                        "**ูุฏุฑุฏุงู ุฑุณู:** ูุฏุฑุฏุงู ุงุฒ ฺฏุฑููโูุง ุฌูุงุฏุ ุงูุฏุงุฏฺฏุฑุงู ู ูุฑููุง ูุฑุฏู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุงูุฏุจุฎุดุ ูุณุฆููุชโูพุฐุฑ ู ุชูุฑฺฉุฒ ุจุฑ ุจุงุฒฺฏุดุช ุจู ุฒูุฏฺฏ.<br>**ูฺฉุชู ฺฉูุฏ:** ุชุนูุฏ ุจู ุจุงุฒุณุงุฒ ฺฉุงูู ู ุฌุจุฑุงู ุฎุณุงุฑุงุช ุจุง ุฐฺฉุฑ ุฌุฏูู ุฒูุงู (ุญุช ฺฉู).'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุดุณุช ุฎุจุฑ ุชูุตู:** ุจุง ุญุถูุฑ ูุฒุฑุง ุฐโุฑุจุท ุจุฑุง ุงุฑุงุฆู ุจุฑูุงูู ุจููุฏูุฏุช ุจุงุฒุณุงุฒ.'
                    }
                }
            ]
        },
        'economic-crisis': {
            title: 'ุจุญุฑุงู ุงูุชุตุงุฏ ู ูุงู ูุงฺฏูุงู',
            description: 'ูุงููุฏ ููุณุงูุงุช ุดุฏุฏ ุงุฑุฒุ ุณููุท ุจูุฑุณุ ุง ุจุญุฑุงูโูุง ุจุงูฺฉ ฺฉู ุงุนุชูุงุฏ ุนููู ุฑุง ุชูุฏุฏ ูโฺฉูุฏ.',
            icon: '๐',
            phases: [
                {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุงุนูุงู ุขุฑุงูุด:** ุณุฎูฺฏู ุง ุฑุฆุณ ุจุงูฺฉ ูุฑฺฉุฒ ููุฑุงู ุจุง ฺฉ ุจุงูู ฺฉูุชุงูุ ุซุจุงุช ฺฉู ุงูุชุตุงุฏ ุฑุง ุชุฃุฏ ฺฉูุฏ.",
                        "**ุงุฑุฌุงุน ุชุฎุตุต:** ุงุนูุงู ฺฉูุฏ ฺฉู ุชู ุงูุชุตุงุฏ ุฏููุช ุฏุฑ ุญุงู ุจุฑุฑุณ ุฑุดูโูุง ู ุงุชุฎุงุฐ ุชุฏุงุจุฑ ุงุณุช.",
                        "**ููุงุจูู ุจุง ุดุงุนู:** ุตุฑุงุญุชุงู ูุฑฺฏููู ุดุงุนู ูุจู ุจุฑ ฺฉูุจูุฏ ฺฉุงูุง ุง ูุฑุดฺฉุณุชฺฏ ุจุงูฺฉโูุง ุฑุง ุชฺฉุฐุจ ฺฉูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุชุฎุตุตุ ุขุฑุงู ู ุงุทููุงูโุจุฎุด.<br>**ูพุงู ุงุตู:** "ุฑุดูโูุง ุงู ููุณุงู ุฎุงุฑุฌ/ูุงุจู ูุฏุฑุช ุงุณุช." "ุงุจุฒุงุฑูุง ฺฉูุชุฑู ูุงุฒู ุฏุฑ ุงุฎุชุงุฑ ุฏููุช ูุฑุงุฑ ุฏุงุฑุฏ ู ุจู ฺฉุงุฑ ฺฏุฑูุชู ุฎูุงูุฏ ุดุฏ."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุดุจฺฉูโูุง ุฎุจุฑ ุชุฎุตุต ู ุงูุชุตุงุฏ.**<br>**ุชูุฆุชุฑ/X (ุณุฎูฺฏู ู ุฑุฆุณ ฺฉู ุจุงูฺฉ ูุฑฺฉุฒ).**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุจุฑูุงูู ุนููุงุช:** ุงุนูุงู ฺูุฏ ุงูุฏุงู ููููุณ (ูุงููุฏ ุชุฒุฑู ุงุฑุฒุ ุชุบุฑ ุณุงุนุช ุจุงุฒุงุฑ) ฺฉู ุฏุฑ ุญุงู ุงูุฌุงู ุงุณุช.",
                        "**ููุถุน ุชุฎุตุต:** ุงุฒ ฺฉุงุฑุดูุงุณุงู ู ุงูุชุตุงุฏุฏุงูุงู ููุฑุฏ ุงุนุชูุงุฏ ุฏููุช ุจุฑุง ุชุญูู ุชุฎุตุต ุงุณุชูุงุฏู ุดูุฏ.",
                        "**ูพุฑูุฒ ุงุฒ ููุตุฑููุง:** ุงุฒ ุงูุฏุงุฎุชู ุชูุงู ุชูุตุฑ ุจู ฺฏุฑุฏู \"ุฏุดูู\" ูพุฑูุฒ ุดูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุชุญููุ ูุชุนูุฏ ุจู ุดูุงูุช ู ุงูุฏุงู.<br>**ูฺฉุชู ฺฉูุฏ:** ุงุฑุงุฆู ุฏุงุฏูโูุง ูพุดุชุจุงู ุจุฑุง ุงุซุจุงุช ุชูุงูุง ุฏููุช ุฏุฑ ูุฏุฑุช ุจุญุฑุงู.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ูุฒฺฏุฑุฏ ุงูุชุตุงุฏ).**<br>**ูุจโุณุงุช ุฑุณู ุฏููุช (PDF ุชุญูู).**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ูุชุงุฌ ุงููู ุงูุฏุงูุงุช:** ุงุนูุงู ููููุชโูุง ุงููู ุฏุฑ ุชุซุจุช ุจุงุฒุงุฑ (ุญุช ุฌุฒุฆ).",
                        "**ุจุฑูุงูู ุจููุฏูุฏุช:** ุชุดุฑุญ ุทุฑุญโูุง ุณุงุฎุชุงุฑ ุฏููุช ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ ุจุญุฑุงู.",
                        "**ฺฏูุชฺฏู ุจุง ุจุฎุด ุฎุตูุต:** ุจุฑฺฏุฒุงุฑ ูุดุณุช ุฎุจุฑ ุจุง ุญุถูุฑ ููุงูุฏฺฏุงู ุจุฎุด ุฎุตูุต."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุขูุฏูโูฺฏุฑ ู ุงุตูุงุญโฺฏุฑ.<br>**ูฺฉุชู ฺฉูุฏ:** ุชูุฑฺฉุฒ ุจุฑ ุงูฺฉู ุงู ฺฉ \"ููุณุงู\" ุจูุฏู ู ูู \"ูุฑููพุงุด\"."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุตุงุญุจู ุจุง ุฑูุฒูุงููโูุง ูุฑุฌุน.**'
                    }
                }
            ]
        },
        'infrastructure-failure': {
            title: 'ุจุญุฑุงู ุฒุฑุณุงุฎุช ู ุฎุฏูุงุช ุญุงุช',
            description: 'ูุงููุฏ ูุทุน ุจุฑู ุณุฑุงุณุฑุ ุงุฎุชูุงู ุฏุฑ ุดุจฺฉู ุญููโููููุ ุขุจุ ุง ุงุฑุชุจุงุทุงุช ฺฉู ุฒูุฏฺฏ ุฑูุฒูุฑู ุฑุง ูุฎุชู ูโฺฉูุฏ.',
            icon: 'โก',
            phases: [
                 {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุชุฃุฏ ูุดฺฉู:** ุชุฃุฏ ุณุฑุน ููุน ูุดฺฉู (ูุซูุงู \"ุงุฎุชูุงู ุฏุฑ ุดุจฺฉู ุณุฑุงุณุฑ ุจุฑู\").",
                        "**ุงุนูุงู ุฌุฏูู ุฒูุงู ุชุฎูู:** ุงุฑุงุฆู ฺฉ ุจุงุฒู ุฒูุงู ุญุฏูุฏ ุจุฑุง ุฑูุน ูุดฺฉู.",
                        "**ุนุฐุฑุฎูุงู ุตุฑุญ:** ุณุฎูฺฏู ุจุงุฏ ุตุฑุญ ู ุดูุงู ุจุงุจุช ุงุฌุงุฏ ุฒุญูุช ุนุฐุฑุฎูุงู ฺฉูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุตุงุฏูุงููุ ูุชุฃุณูุ ู ูุชูุฑฺฉุฒ ุจุฑ ุญู ูุดฺฉู.<br>**ูพุงู ุงุตู:** "ูุดฺฉู ุดูุงุณุง ุดุฏู ุงุณุช ู ุชูโูุง ูู ุฏุฑ ูุญู ุญุถูุฑ ุฏุงุฑูุฏ." "ุนุฐุฑุฎูุงู ูโฺฉูู ู ุฏุฑ ุชูุงุดู ุฒูุงู ุฑุง ุจู ุญุฏุงูู ุจุฑุณุงูู."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุฑุณุงููโูุง ูุญู ู ุงุณุชุงู.**<br>**ุชูุฆุชุฑ/X (ุณุฎูฺฏู ู ูุฒุงุฑุช ูุฑู/ุฑุงู).**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุนุงูู ู ููุตุฑ:** ุงุนูุงู ุนูุช ุงุตู ุญุงุฏุซู (ููุ ุงูุณุงูุ ุฎุฑุงุจฺฉุงุฑ) ุจุฏูู ูุฑุงูฺฉู.",
                        "**ูุชุงุฌ ููุฑ:** ุงุนูุงู ููุงุทู/ุจุฎุดโูุง ฺฉู ูุดฺฉูุดุงู ุญู ุดุฏู ุงุณุช.",
                        "**ุชูุฑฺฉุฒ ุจุฑ ฺฉุงุฑุขูุฏ:** ุงูุชุดุงุฑ ุชุตุงูุฑ ู ูุฏุฆู ุงุฒ ูุนุงูุช ุดุจุงููโุฑูุฒ ุชูโูุง ูู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ฺฉุงุฑุขูุฏุ ูุณุฆููุชโูพุฐุฑุ ู ูู.<br>**ูฺฉุชู ฺฉูุฏ:** ุจุงุฏ ูุฑุฏ/ุงูุฑุงุฏ ฺฉู ุฏุฑ ุงุฌุงุฏ ุง ุงููุงู ููุด ุฏุงุดุชูโุงูุฏ ูุนุฑู ุดููุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ุจุฎุด ุฎุจุฑ).**<br>**ูพูุชูุฑูโูุง ุฏุงุฎู (ูพุงูโุฑุณุงู).**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ุจุฑุฎูุฑุฏ ุจุง ูุตูุฑ:** ุงุนูุงู ูุทุน ุจุฑุฎูุฑุฏ ุงุฏุงุฑ/ูุถุง ุจุง ููุตุฑุงู.",
                        "**ูุนุฏู ุณุฑูุงูโฺฏุฐุงุฑ:** ุชุดุฑุญ ุจุฑูุงูู ฺฉูุชุงูโูุฏุช ู ุจููุฏูุฏุช ุฏููุช ุจุฑุง ููุณุงุฒ ุฒุฑุณุงุฎุช.",
                        "**ฺฏุฒุงุฑุด ูุงู ุฎุณุงุฑุช:** ุงุฑุงุฆู ฺฉ ุจุฑุขูุฑุฏ ุงููู ุงุฒ ุฎุณุงุฑุช ู ุชุนูุฏ ุจู ุฌุจุฑุงู ุขู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุงุตูุงุญโฺฏุฑุ ูุชุนูุฏ ุจู ูพุดฺฏุฑ.<br>**ูฺฉุชู ฺฉูุฏ:** ูุฑุฏู ุจุงุฏ ุงุญุณุงุณ ฺฉููุฏ ฺฉู ุงู ุจุญุฑุงูุ ูุญุฑฺฉ ุงุตูุงุญุงุช ุนููโุชุฑ ุฎูุงูุฏ ุดุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ฺฉููุฑุงูุณ ุฎุจุฑ ูุฒุฑ ุฐโุฑุจุท.**'
                    }
                }
            ]
        },
        'public-health': {
            title: 'ุจุญุฑุงู ุณูุงูุช ุนููู ู ุงูพุฏูโูุง',
            description: 'ูุงููุฏ ุดูุน ุจูุงุฑโูุง ูุงฺฏุฑุ ูุณูููุชโูุง ฺฏุณุชุฑุฏู ุง ุญูุงุฏุซ ุจูุฏุงุดุช ฺฉู ุณูุงูุช ุฌุงูุนู ุฑุง ุจู ุฎุทุฑ ูโุงูุฏุงุฒุฏ.',
            icon: '๐ฅ',
            phases: [
                {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุชุฃุฏ ุจุง ุงุญุชุงุท:** ุชุฃุฏ ูุฌูุฏ ูุดฺฉู ู ููุงุฏ ูุชูู (ูุฒุงุฑุช ุจูุฏุงุดุช) ุจู ุนููุงู ุชููุง ูุฑุฌุน ุงุทูุงุนโุฑุณุงู.",
                        "**ูพุงูโูุง ุงููู ุจูุฏุงุดุช:** ุงูุชุดุงุฑ ุชูุตูโูุง ุจูุฏุงุดุช ุณุงุฏู ู ุนูู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ฺฏุณุชุฑุด.",
                        "**ููุงุจูู ุจุง ูุญุดุช:** ุชุฃฺฉุฏ ุจุฑ ุนุฏู ูุงุฒ ุจู ูุญุดุช ู ุชุญุช ฺฉูุชุฑู ุจูุฏู ูุถุนุช."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุขุฑุงูุดโุจุฎุดุ ุชุฎุตุต ู ุชูุตูโุง.<br>**ูพุงู ุงุตู:** "ุฎุทุฑ ูุฌูุฏ ุฏุงุฑุฏุ ุงูุง ูุฏุฑุช ูโุดูุฏ. ููฺฉุงุฑ ูุฑุฏู ุจุง ุชูุตูโูุง ุจูุฏุงุดุช ฺฉูุฏ ุงุณุช."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุดุจฺฉู ุณูุงูุช (ุชููุฒูู) ู ูุจโุณุงุช ูุฒุงุฑุช ุจูุฏุงุดุช.**<br>**ุชูุฆุชุฑ/X.**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุขูุงุฑ ุฑูุฒุงูู:** ุขุบุงุฒ ุงูุชุดุงุฑ ุขูุงุฑ ุฑุณู ุฏุฑ ฺฉ ุณุงุนุช ูุดุฎุต ูุฑ ุฑูุฒ.",
                        "**ููุงุด ุขูุงุฏฺฏ:** ุงูุชุดุงุฑ ุชุตุงูุฑ ู ููู ุงุฒ ูุฑุงฺฉุฒ ุฏุฑูุงูุ ูุฑูุทูู ู ุงูุจุงุฑ ุฏุงุฑู.",
                        "**ุงุฑุฌุงุน ุจู ูุชุฎุตุตุงู:** ุงุณุชูุงุฏู ุงุฒ ูพุฒุดฺฉุงู ู ูุชุฎุตุตุงู ูุดููุฑ ุจุฑุง ุชุฃุฏ ุฑูุงุช ุฏููุช."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ููุชุฏุฑุ ุฏุงุฏูโูุญูุฑ ู ูพุดุฑู.<br>**ูฺฉุชู ฺฉูุฏ:** ูพุฑูุฒ ุงุฒ ูพููุงูโฺฉุงุฑ ุขูุงุฑ. ุดูุงูุชุ ุงุนุชูุงุฏ ุฑุง ุญูุธ ูโฺฉูุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ูุตุงุญุจู ุจุง ูุฒุฑ ุจูุฏุงุดุช).**<br>**ุงูููฺฏุฑุงูฺฉโูุง.**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ุจุฑูุงูู ูุงฺฉุณูุงุณูู/ุฏุฑูุงู:** ุงุนูุงู ุจุฑูุงูู ุฏูู ู ุฒูุงูโุจูุฏโุดุฏู ุจุฑุง ุชูุฒุน ุฏุงุฑู ุง ูุงฺฉุณู.",
                        "**ฺฏุฒุงุฑุด ููุดุฃ:** ุงุฑุงุฆู ฺฉ ฺฏุฒุงุฑุด ุฎูุงุตู ุฏุฑุจุงุฑู ููุดุฃ ู ูุญูู ูุฑูุฏ ุจูุงุฑ.",
                        "**ุญูุงุช ุงุฒ ฺฉุงุฏุฑ ุฏุฑูุงู:** ุจุฑุฌุณุชู ฺฉุฑุฏู ุชูุงุด ู ูุฏุงฺฉุงุฑ ฺฉุงุฏุฑ ุฏุฑูุงู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูุฏุฑุฏุงูุ ุขูุฏูโูฺฏุฑุ ู ูุชุนูุฏ ุจู ุณูุงูุช ุฌุงูุนู.<br>**ูฺฉุชู ฺฉูุฏ:** ุชูุฑฺฉุฒ ุจุฑ ุงูุฏุงูุงุช ูพุดฺฏุฑ ุทููุงูโูุฏุช.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุจุงููโ ุฑุณู ู ฺฏุฒุงุฑุด ุชูุตู ุฏุฑ ูุจโุณุงุช ุฏููุช.**'
                    }
                }
            ]
        },
        'governance-corruption': {
            title: 'ุจุญุฑุงู ุญฺฉูุฑุงู ู ูุณุงุฏ ุณุงุณ',
            description: 'ูุงููุฏ ฺฉุดู ูพุฑููุฏู ุจุฒุฑฺฏ ูุณุงุฏุ ุงุณุชุนูุง ุงุฌุจุงุฑ ฺฉ ููุงู ุงุฑุดุฏุ ุง ุฑุณูุงโูุง ุณุงุณ.',
            icon: '๐๏ธ',
            phases: [
                 {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ููุถุน ูุงุทุน:** ุณุฎูฺฏู ููุฑุงู ุจุฑ ุนุฒู ุฏููุช ุจุฑุง ูุจุงุฑุฒู ุจโูุฏ ู ุดุฑุท ุจุง ูุณุงุฏ ุชุฃฺฉุฏ ฺฉูุฏ.",
                        "**ุญูุงุช ุงุฒ ููู ูุถุงุฆู:** ุงุนูุงู ุญูุงุช ฺฉุงูู ุงุฒ ุฑููุฏ ุฑุณุฏฺฏ ูุถุง.",
                        "**ูพุฐุฑุด ูุณุฆููุช:** ุฏุฑ ุตูุฑุช ุงุซุจุงุช ูุตูุฑุ ุนุฐุฑุฎูุงู ุจุงุจุช ุงุนุชูุงุฏ ูุงุฏุฑุณุช."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูุงุทุนุ ุจโุฑุญู ุฏุฑ ุจุฑุงุจุฑ ูุณุงุฏุ ู ูุชุนูุฏ ุจู ุดูุงูุช.<br>**ูพุงู ุงุตู:** "ุฎุท ูุฑูุฒ ุฏููุชุ ูุณุงุฏ ุงุณุช ู ุจุง ูฺฺฉุณ ุชุนุงุฑู ูุฏุงุฑู."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ุจุฎุด ุฎุจุฑ ููุฑ).**<br>**ุชูุฆุชุฑ/X.**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุงูุฏุงู ุงุตูุงุญ:** ุงุนูุงู ุงูุฏุงูุงุช ููุฑ ุฏููุช (ูุงููุฏ ุจุฑฺฉูุงุฑ ูุฏุฑุงู).",
                        "**ุชูุฑฺฉุฒ ุจุฑ ุณุณุชู:** ุชุฃฺฉุฏ ุจุฑ ุงูฺฉู ูุดฺฉูุ ุณุณุชูุงุชฺฉ ูุณุช ู ูุชูุฌู ูุฑุฏ ูุงุณุฏ ุจูุฏู.",
                        "**ุงุฑุงุฆู ูุณุชูุฏุงุช:** ุงูุชุดุงุฑ ุฎูุงุตูโุง ุงุฒ ุงูุฏุงูุงุช ูุธุงุฑุช ูพุดฺฏุฑุงูู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุงุตูุงุญโฺฏุฑุ ุดูุงู ู ูุชุนูุฏ ุจู ูพุงฺฉโุณุงุฒ.<br>**ูฺฉุชู ฺฉูุฏ:** ูุจุงุฏ ุงุฌุงุฒู ุฏุงุฏ ุงูฺฉุงุฑ ุนููู ุจู ุณูุช ูุณุงุฏ ุณุณุชู ููุญุฑู ุดูุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุฑูุฒูุงููโูุง ูุฑุฌุน.**<br>**ูุดุณุช ุฎุจุฑ ุณุฎูฺฏู.**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ุงุฌุงุฏ ุณุณุชู ูุธุงุฑุช ุฌุฏุฏ:** ุงุนูุงู ุฌุฒุฆุงุช ุทุฑุญ ุฏููุช ุจุฑุง ุงูุฒุงุด ุดูุงูุช.",
                        "**ุจุงุฒฺฏุดุช ุงููุงู:** ุชุนูุฏ ุตุฑุญ ุจู ุจุงุฒฺฏุฑุฏุงูุฏู ุงููุงู ุนููู ุจู ุฎุฒุงูู.",
                        "**ุชุนุงูู ุจุง ููุชูุฏุงู:** ูพุงุณุฎ ู ุชูุฏุฑ ุงุฒ ููุชูุฏุงู ฺฉู ูพุดโุชุฑ ูุณุงุฏ ุฑุง ฺฏุฒุงุฑุด ุฏุงุฏู ุจูุฏูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูพุงุณุฎฺฏูุ ุขูุฏูโูฺฏุฑุ ู ุดูุงูุชโูุญูุฑ.<br>**ูฺฉุชู ฺฉูุฏ:** ููุงุด ุงูฺฉู ุฏููุช ุฏุฑ ุญุงู ุชุจุฏู ุชูุฏุฏ ุจู ูุฑุตุช ุจุฑุง ุงุตูุงุญ ุงุณุช.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุจุงูู ุฑุณู ุฏููุช ุจุง ุฌุฒุฆุงุช ุทุฑุญ ุงุตูุงุญ.**'
                    }
                }
            ]
        },
        'diplomatic-foreign': {
            title: 'ุจุญุฑุงู ุฏูพููุงุณ ู ุฎุงุฑุฌ',
            description: 'ูุงููุฏ ุชูุด ุจุง ฺฉุดูุฑ ููุณุงูุ ููุถ ูุนุงูุฏุงุช ุจูโุงููููุ ุงุนูุงู ุชุญุฑูโูุง ุฌุฏุฏ ุง ุญูุงุฏุซ ุฏูพููุงุชฺฉ.',
            icon: '๐',
            phases: [
                {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ููุถุน ุฑุณู:** ุงูุชุดุงุฑ ููุถุน ุฑุณู ูุฒุงุฑุช ุฎุงุฑุฌู ุจุง ุงุฏุจุงุช ุฏูู ุฏูพููุงุชฺฉ.",
                        "**ุขุฑุงูโุณุงุฒ ุฏุงุฎู:** ุณุฎูฺฏู ุจู ูุฑุฏู ุงุทููุงู ุฏูุฏ ฺฉู ุงุจุฒุงุฑูุง ูุงุฒู ุจุฑุง ูุฏุฑุช ุชูุด ุจู ฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.",
                        "**ูพุฑูุฒ ุงุฒ ุชุญุฑฺฉ:** ุตุฑุงุญุชุงู ุงุฒ ุฑุณุงููโูุง ุฏุงุฎู ุฎูุงุณุชู ุดูุฏ ุงุฒ ุฏุงูู ุฒุฏู ุจู ุงุญุณุงุณุงุช ุชูุฏ ุจูพุฑูุฒูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุณูุฌุฏูุ ุฎูุดุชูโุฏุงุฑุ ุงูุง ูุงุทุน.<br>**ูพุงู ุงุตู:** "ููุงูุน ูู ุฎุท ูุฑูุฒ ูุงุณุช. ูุง ุขูุงุฏู ฺฏูุชฺฏู ู ุฏูุงุน ุงุฒ ุญููู ููุช ูุณุชู."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุฒุงุฑุช ุงููุฑ ุฎุงุฑุฌู (ุณุงุช ุฑุณู ู ุชูุฆุชุฑ).**<br>**ุชูุฆุชุฑ/X (ุณุฎูฺฏู).**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุชุจู ุฌุฒุฆุงุช ุญููู:** ุงุณุชูุงุฏู ุงุฒ ฺฉุงุฑุดูุงุณุงู ุญููู ุจูโุงูููู ุจุฑุง ุชูุฌู ููุถุน ุงุฑุงู.",
                        "**ููุงุด ุงุฌูุงุน:** ุจุฑฺฏุฒุงุฑ ูุดุณุช ุฎุจุฑ ุจุง ุญุถูุฑ ููุงูุฏฺฏุงู ุงุฒ ููุงุฏูุง ูุฎุชูู.",
                        "**ฺฉูุชุฑู ุฎุดู:** ฺฉูุชุฑู ุดุฏุฏ ุจุฑ ูพุงูโูุง ุชุง ุดุงูุณ ุฏูพููุงุณ ุงุฒ ุจู ูุฑูุฏ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ููุทูุ ูุณุชุฏูุ ู ูุชุญุฏ.<br>**ูฺฉุชู ฺฉูุฏ:** ุฑูุงุช ุจุงุฏ ุจุฑ ุฑู \"ูุงููู\" ู \"ุญููู ุงุฑุงู\" ูุชูุฑฺฉุฒ ุดูุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชููุฒูู ูู (ุจุฑูุงููโูุง ุชุญูู).**<br>**ุฎุจุฑฺฏุฒุงุฑโูุง ุฎุงุฑุฌ (ุณุฎูฺฏู).**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ฺฏุงู ุจุนุฏ ุฏูพููุงุณ:** ุงุนูุงู ูุงุถุญ ฺฏุงู ุจุนุฏ ุฏููุช (ูุฐุงฺฉุฑูุ ุงุฑุฌุงุน ุจู ุณุงุฒูุงู ุจูโุงูููู).",
                        "**ุนุงุฏโุณุงุฒ:** ุชูุฑฺฉุฒ ุจุฑ ูุนุงูุชโูุง ุฌุงุฑ ุฏููุช ุฏุฑ ุญูุฒูโูุง ุฏฺฏุฑ.",
                        "**ูพุงู ุจู ุฑุณุงููโูุง ุฎุงุฑุฌ:** ุจุฑฺฏุฒุงุฑ ฺฉ ุฌูุณู ูพุฑุณุด ู ูพุงุณุฎ ุจุฑุง ุฎุจุฑูฺฏุงุฑุงู ุฎุงุฑุฌ."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุงูุฏูุงุฑุ ุฑุงูุจุฑุฏ ู ูพุดุฑู.<br>**ูฺฉุชู ฺฉูุฏ:** ูุดุงู ุฏุงุฏู ูุฏุฑุช ุฏูพููุงุณ ูุนุงู ุฏููุช.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุตุงุญุจู ุชููุฒูู ูุฒุฑ ุฎุงุฑุฌู.**'
                    }
                }
            ]
        },
        'social-protests': {
            title: 'ุจุญุฑุงู ุงุฌุชูุงุน ู ุงุนุชุฑุงุถุงุช ูุฑุฏู',
            description: 'ูุงููุฏ ุชุฌูุนุงุช ฺฏุณุชุฑุฏูุ ูุงุฑุถุงุชโูุง ููุทููโุง ุง ุตูู ฺฉู ูุงุฒููุฏ ุดูุฏู ุตุฏุง ูุฑุฏู ู ูุฏุฑุช ุงุณุช.',
            icon: '๐ฅ',
            phases: [
                 {
                    name: 'ุงุนูุงู ุงููู',
                    actions: [
                        "**ุชุฃุฏ ุดูุฏู:** ุณุฎูฺฏู ููุฑุงู ุชุฃุฏ ฺฉูุฏ ฺฉู \"ุตุฏุง ูุฑุฏู ุดูุฏู ุดุฏู ู ุฏููุช ุฏุฑ ุญุงู ุจุฑุฑุณ ุฎูุงุณุชูโูุงุณุช.\"",
                        "**ุชูุงุฒฺฏุฐุงุฑ:** ุชูุงุฒ ุตุฑุญ ุจู \"ูุนุชุฑุถ\" ู \"ุงุบุชุดุงุดฺฏุฑ\" ูุงุฆู ุดูุฏ.",
                        "**ุฏุฑุฎูุงุณุช ุขุฑุงูุด:** ุฏุฑุฎูุงุณุช ุฑุณู ุจุฑุง ุขุฑุงูุด ู ูพุฑูุฒ ุงุฒ ุฎุดููุช ุงุฒ ุณู ูุฑุฏู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ุดูููุฏูุ ููุฏูุ ู ุชูุงุฒุฏููุฏู.<br>**ูพุงู ุงุตู:** "ูุง ุฏุฑ ฺฉูุงุฑ ูุฑุฏู ูุณุชู ู ุญู ุงุนุชุฑุงุถ ุฑุง ูุญุชุฑู ูโุดูุงุฑูุ ุงูุง ุงููุช ุฎุท ูุฑูุฒ ุงุณุช."'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุชูุฆุชุฑ/X.**<br>**ุชููุฒูู ูู.**'
                    }
                },
                {
                    name: 'ูุฏุฑุช ุงุทูุงุนุงุช',
                    actions: [
                        "**ุดูุงุณุง ูุชูู:** ุงุนูุงู ุฑุณู ฺฉูุชู ุง ูุฑุฏ ุฏุฑ ุฏููุช ุจุฑุง ุฑุณุฏฺฏ ุจู ุฎูุงุณุชูโูุง.",
                        "**ูพุฑูุฒ ุงุฒ ุงูฺฉุงุฑ:** ุงุฒ ุจู ุญุฏุงูู ุฑุณุงูุฏู ุง ุงูฺฉุงุฑ ุงุจุนุงุฏ ุงุนุชุฑุงุถุงุช ุฎูุฏุฏุงุฑ ุดูุฏ.",
                        "**ุดูุงูโุณุงุฒ ุชููุงุช/ุจุงุฒุฏุงุดุชโูุง:** ุงูุชุดุงุฑ ุขูุงุฑ ุชุฃุฏ ุดุฏู ู ุชุฃฺฉุฏ ุจุฑ ุฑุณุฏฺฏ ูุงููู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูพุงุณุฎฺฏูุ ูุชุนูุฏ ุจู ุงุตูุงุญ ู ุดูุงู.<br>**ูฺฉุชู ฺฉูุฏ:** ูพุฑูุฒ ุงุฒ ูุฑุงูฺฉู. ุชูุฑฺฉุฒ ุจุฑ ุฑุงูฺฉุงุฑูุง ุฏุงุฎู.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ุฑุณุงูู ูู (ฺฏุฒุงุฑุดโูุง ุฎุจุฑ).**<br>**ูพูุชูุฑูโูุง ุฏุงุฎู.**'
                    }
                },
                {
                    name: 'ุชุฑูู ุงุนุชูุงุฏ',
                    actions: [
                        "**ุงุนูุงู ุงูุฏุงู ุงุตูุงุญ:** ุงุนูุงู ุงูุฏุงูุงุช ููููุณ ุฏููุช ุจุฑุง ูพุงุณุฎ ุจู ูุทุงูุจู.",
                        "**ฺฏูุชฺฏู ุจุง ููุงูุฏฺฏุงู:** ุงูุชุดุงุฑ ุชุตุงูุฑ ู ุฎูุงุตูโุง ุงุฒ ุฌูุณุงุช ฺฏูุชฺฏู ุจุง ููุงูุฏฺฏุงู ูุนุชุฑุถุงู.",
                        "**ุจุฑูุงูู ุจููุฏูุฏุช:** ุชุดุฑุญ ุจุฑูุงูู ุฏููุช ุจุฑุง ุชุนุงูู ุฏุงุฆู ุจุง ูุฑุฏู."
                    ],
                    guidance: {
                        title: 'ุฑุงูููุง ูุญุชูุง ู ูุญู',
                        text: '**ูุญู:** ูุชุนูุฏ ุจู ุชุบุฑุ ุขุดุชโุฌู ู ุขูุฏูโูฺฏุฑ.<br>**ูฺฉุชู ฺฉูุฏ:** ููุงุด ุงูฺฉู ุฏููุช ูุนุชุฑุถุงู ุฑุง ุฏุดูู ููโุฏุงูุฏ.'
                    },
                    channels: {
                        title: 'ฺฉุงูุงูโูุง ุงูุชุดุงุฑ ูุฏูููุฏ',
                        text: '**ูุตุงุญุจู ุณุฎูฺฏู ุง ุฑุฆุณโุฌูููุฑ.**'
                    }
                }
            ]
        }
    };

    let currentCrisisContext = {
        title: '',
        phaseName: '',
        actions: []
    };
    
    // API Configuration
    // ๐ ุชูุฌู ููู: ุจุฑุง ุงุฌุฑุง ุงู ุณุงุช ุฏุฑ ุฎุงุฑุฌ ุงุฒ ูุญุท ุฌููุงุ ุจุงุฏ ฺฉูุฏ API ุฎูุฏ ุฑุง ุงูุฌุง ูุฑุงุฑ ุฏูุฏ.
    // ฺฉูุฏ ุฑุง ุงุฒ Google AI Studio ุฏุฑุงูุช ฺฉูุฏ ู ุฏุงุฎู ฺฏูููโูุง ูุฑุงุฑ ุฏูุฏ.
    const apiKey = "AIzaSyC2jGvwqZTv3JEWkNghsADdV12rZvl1az0"; 
    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

    const crisisGrid = document.getElementById('crisis-grid');
    const protocolDisplay = document.getElementById('protocol-display');
    const crisisTitle = document.getElementById('crisis-title');
    const crisisDescription = document.getElementById('crisis-description');
    const phaseTabs = document.getElementById('phase-tabs');
    const phaseContent = document.getElementById('phase-content');
    const timelineProgress = document.getElementById('timeline-progress');
    const showPrinciplesBtn = document.getElementById('showPrinciplesBtn');
    const closePrinciplesBtn = document.getElementById('closePrinciplesBtn');
    const principlesModal = document.getElementById('principlesModal');

    // Drafting Tool Elements
    const critiqueDraftBtn = document.getElementById('critiqueDraftBtn');
    const draftInput = document.getElementById('draftInput');
    const critiqueOutput = document.getElementById('critiqueOutput');
    const critiqueContent = document.getElementById('critiqueContent');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const critiqueIcon = document.getElementById('critiqueIcon');
    const draftMessage = document.getElementById('draftMessage'); // New element for validation messages

    function formatText(text) {
        return text.replace(/\*\*(.*?)\*\*/g, '<strong class="font-bold text-slate-900">$1</strong>');
    }
    
    function createChecklistItem(text) {
        return `
            <li class="flex items-start mb-3">
                <span class="text-indigo-500 mt-1 ml-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                </span>
                <span class="text-slate-700">${formatText(text)}</span>
            </li>
        `;
    }

    function displayPhaseContent(crisis, phaseIndex) {
        const phase = crisis.phases[phaseIndex];
        let contentHTML = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-slate-50 rounded-lg p-4">
                    <h4 class="font-bold text-lg mb-3">ุงูุฏุงู ุฑุณุงููโุง ฺฉูุฏ (ฺฺฉโูุณุช)</h4>
                    <ul class="space-y-2">
                        ${phase.actions.map(createChecklistItem).join('')}
                    </ul>
                </div>
                <div class="space-y-4">
                    <div class="bg-amber-50 rounded-lg p-4">
                        <h4 class="font-bold text-lg mb-2 text-amber-800">${phase.guidance.title}</h4>
                        <p class="text-amber-900 leading-relaxed">${formatText(phase.guidance.text)}</p>
                    </div>
                    <div class="bg-sky-50 rounded-lg p-4">
                        <h4 class="font-bold text-lg mb-2 text-sky-800">${phase.channels.title}</h4>
                        <p class="text-sky-900 leading-relaxed">${formatText(phase.channels.text)}</p>
                    </div>
                </div>
            </div>`;
        phaseContent.innerHTML = contentHTML;
        
        document.querySelectorAll('.tab').forEach((tab, index) => {
            if (index === phaseIndex) {
                tab.classList.add('tab-active');
            } else {
                tab.classList.remove('tab-active');
            }
        });

        const progressWidths = [16.6, 50, 83.3];
        timelineProgress.style.width = `${progressWidths[phaseIndex]}%`;
        
        document.querySelectorAll('.timeline-step').forEach((step, index) => {
            step.classList.toggle('text-indigo-600', index <= phaseIndex);
            step.classList.toggle('text-slate-500', index > phaseIndex);
        });

        // Update current crisis context for LLM critique
        currentCrisisContext = {
            title: crisis.title,
            phaseName: phase.name,
            actions: phase.actions
        };
    }

    function selectCrisis(crisisKey) {
        const crisis = crisisData[crisisKey];
        crisisTitle.textContent = crisis.title;
        crisisDescription.textContent = crisis.description;

        phaseTabs.innerHTML = '';
        crisis.phases.forEach((phase, index) => {
            const tab = document.createElement('button');
            tab.textContent = phase.name;
            tab.className = 'tab py-2 px-4 border-b-2 border-transparent text-slate-600 hover:border-slate-300 hover:text-slate-800 transition-colors';
            tab.dataset.phaseIndex = index;
            tab.addEventListener('click', () => displayPhaseContent(crisis, index));
            phaseTabs.appendChild(tab);
        });

        displayPhaseContent(crisis, 0);
        protocolDisplay.classList.remove('hidden');
        protocolDisplay.scrollIntoView();

        document.querySelectorAll('.crisis-card').forEach(card => {
            card.classList.toggle('crisis-card-active', card.dataset.crisisKey === crisisKey);
        });
    }
    
    function displayDraftMessage(message, isError = true) {
        draftMessage.textContent = message;
        draftMessage.classList.remove('hidden');
        draftMessage.classList.toggle('text-red-600', isError);
        draftMessage.classList.toggle('text-green-600', !isError);
        setTimeout(() => draftMessage.classList.add('hidden'), 3000);
    }

    // --- LLM Critique Logic ---
    async function critiqueDraft(draftText) {
        if (!draftText.trim()) {
            displayDraftMessage('ูุทูุงู ูุชู ูพุดโููุณ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ.');
            return;
        }

        if (!apiKey) {
             displayDraftMessage('๐ ฺฉูุฏ API ฺฏูู ูุงุฑุฏ ูุดุฏู ุงุณุช. ูุทูุงู ุขู ุฑุง ุฏุฑ ฺฉุฏ HTML ูุงุฑุฏ ฺฉูุฏ ุชุง ุงุจุฒุงุฑ ุชุญูู ูุนุงู ุดูุฏ.', true);
             return;
        }

        // Clear previous messages
        draftMessage.classList.add('hidden');

        critiqueDraftBtn.disabled = true;
        loadingSpinner.classList.remove('hidden');
        critiqueIcon.classList.add('hidden');
        critiqueOutput.classList.remove('hidden');
        critiqueContent.innerHTML = '<p class="text-center text-indigo-600">ููุด ูุตููุน ุฏุฑ ุญุงู ุชุญูู ูุชู ุงุณุช. ูุทูุงู ุตุจุฑ ฺฉูุฏ...</p>';

        const systemPrompt = `
ุดูุง ฺฉ ุชุญููฺฏุฑ ุงุฑุดุฏ ุงุฑุชุจุงุทุงุช ุจุญุฑุงู ูุณุชุฏ. ูุธูู ุดูุง ููุฏ ู ุจุฑุฑุณ ฺฉ ูพุดโููุณ ุจุงูู ุนููู ุจุฑ ุงุณุงุณ ุงุตูู ูุงฺฉูุด ุณุฑุน ุณุฎูฺฏู ุงุณุช.
- **ููุถูุน ุจุญุฑุงู:** ${currentCrisisContext.title}
- **ูุงุฒ ุฒูุงู:** ${currentCrisisContext.phaseName}
- **ุงูุฏุงูุงุช ุถุฑูุฑ ุฏุฑ ุงู ูุงุฒ:** ${currentCrisisContext.actions.join('ุ ')}

ูุชู ุฑุง ุจุฑ ุงุณุงุณ ุงู ูุนุงุฑูุง ููุฏ ฺฉูุฏ:
1. **ูุญู:** ุขุง ููุงุณุจ ุจุญุฑุงู ุงุณุชุ (ูุซูุงู ูุงุทุนุ ููุฏูุงููุ ุชุฎุตุต).
2. **ุงุตูู:** ุขุง ุงุตู "ูุณุฆููุชโูพุฐุฑ ุจุฑ ุชูุฌู" ู "ุงูุณุงูโุณุงุฒ" ุฑุนุงุช ุดุฏู ุงุณุชุ
3. **ุนููุงุช:** ุขุง ุจู ุงูุฏุงูุงุช ุถุฑูุฑ ูุงุฒ ูุนู ูุฒุฏฺฉ ุงุณุชุ

ูพุงุณุฎ ุดูุง ุจุงุฏ ุญุชูุงู ุจู ุฒุจุงู ูุงุฑุณ ู ุจุง ุฑุนุงุช ุฏูู ุณุงุฎุชุงุฑ Markdown ุฒุฑ ุจุงุดุฏ:

### ููุฏ ุชุฎุตุต ูุญู ู ูุญุชูุง
[ูุชู ููุฏ ู ุชุญูู ุดูุง]

### ูพุดููุงุฏ ุจูุจูุฏ ูุญู ู ูพุงู ุงุตู
[ูพุดููุงุฏูุง ุนูู ุจุฑุง ุงุตูุงุญ ูุญู ู ุชูุฑฺฉุฒ ูพุงู]

### ุฎูุงุตู ุขูุงุฏู ุจุฑุง ุชูุฆุชุฑ/X
[ุฎูุงุตู ุญุฏุงฺฉุซุฑ ฒธฐ ฺฉุงุฑุงฺฉุชุฑ ุจุฑุง ุงูุชุดุงุฑ ููุฑ ุฏุฑ ุดุจฺฉูโูุง ุงุฌุชูุงุน]
        `.trim(); 

        const userQuery = `ูพุดโููุณ ุจุงูู: \n\n ${draftText}`;

        const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
            systemInstruction: {
                parts: [{ text: systemPrompt }]
            },
        };
        
        const maxRetries = 3;
        let attempt = 0;
        let result = null;

        while (attempt < maxRetries) {
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    // This handles 401/403 (Invalid API Key) or other HTTP errors
                    const errorDetails = await response.text();
                    console.error("Gemini API HTTP Error:", response.status, errorDetails);
                    throw new Error(`API failed with status ${response.status}`);
                }

                result = await response.json();
                break; 

            } catch (error) {
                attempt++;
                if (attempt >= maxRetries) {
                    console.error("Gemini API call failed after multiple retries.", error);
                    // Check specifically for API Key error (though response.ok handles 40x status)
                    const message = apiKey 
                        ? 'ุฎุทุง ุฏุฑ ุงุชุตุงู ุจู ููุด ูุตููุน ูพุณ ุงุฒ ฺูุฏ ุจุงุฑ ุชูุงุด. ูุทูุงู ูุถุนุช ุดุจฺฉู ุฎูุฏ ุง ุงุนุชุจุงุฑ ฺฉูุฏ API ุฑุง ุจุฑุฑุณ ฺฉูุฏ.'
                        : '๐ ฺฉูุฏ API ฺฏูู ูุงุฑุฏ ูุดุฏู ุงุณุช ู ุงูฺฉุงู ุชุญูู ูุฌูุฏ ูุฏุงุฑุฏ.';
                    critiqueContent.innerHTML = `<p class="text-red-600">${message}</p>`;
                    break;
                }
                const delay = Math.pow(2, attempt) * 1000;
                await new Promise(resolve => setTimeout(resolve, delay));
            }
        }
        
        if (result && result.candidates && result.candidates.length > 0) {
            const text = result.candidates[0].content.parts[0].text;
            critiqueContent.innerHTML = convertMarkdownToHtml(text);
        } else if (result) {
            // Handle case where API responded but content is missing (e.g., safety block)
            critiqueContent.innerHTML = '<p class="text-red-600">ููุด ูุตููุน ูุชูุงูุณุช ุชุญูู ููุงุณุจ ุงุฑุงุฆู ุฏูุฏ (ุงุญุชูุงูุงู ุจู ุฏูู ููุถูุน ุญุณุงุณ ุง ุนุฏู ุงูุทุจุงู ูพุงุณุฎ).</p>';
        }

        critiqueDraftBtn.disabled = false;
        loadingSpinner.classList.add('hidden');
        critiqueIcon.classList.remove('hidden');
    }

    function convertMarkdownToHtml(markdownText) {
        let html = markdownText;
        // Convert headers (assuming only ### is used)
        html = html.replace(/###\s*(.*)/g, '<h5 class="text-xl font-bold text-indigo-700 mt-4 pt-4 border-t border-indigo-200">$1</h5>');
        // Convert bold text
        html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        // Convert new lines to paragraphs, preserving Markdown headers first
        html = html.split('\n').map(line => {
            if (line.trim().startsWith('<h5')) {
                return line;
            }
            if (line.trim()) {
                return `<p>${line}</p>`;
            }
            return '';
        }).join('');
        return html;
    }

    critiqueDraftBtn.addEventListener('click', () => {
        critiqueDraft(draftInput.value);
    });

    // Initialize crisis grid
    Object.keys(crisisData).forEach(key => {
        const crisis = crisisData[key];
        const card = document.createElement('div');
        card.className = 'crisis-card bg-white p-4 rounded-xl shadow-md hover:shadow-xl border-2 border-transparent cursor-pointer transition-all duration-300 flex items-center';
        card.dataset.crisisKey = key;
        card.innerHTML = `
            <div class="text-4xl mr-4">${crisis.icon}</div>
            <div>
                <h3 class="font-bold text-lg text-slate-800">${crisis.title}</h3>
            </div>
        `;
        card.addEventListener('click', () => selectCrisis(key));
        crisisGrid.appendChild(card);
    });

    showPrinciplesBtn.addEventListener('click', () => principlesModal.classList.remove('hidden'));
    closePrinciplesBtn.addEventListener('click', () => principlesModal.classList.add('hidden'));
    principlesModal.addEventListener('click', (e) => {
        if (e.target === principlesModal) {
            principlesModal.classList.add('hidden');
        }
    });
});
</script>

</body>
</html>